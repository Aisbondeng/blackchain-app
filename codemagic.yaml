workflows:
  build_blackchain_app:
    name: Build Blackchain Crypto App
    instance_type: mac_mini_m1
    environment:
      vars:
        NODE_ENV: production
      node: latest
    scripts:
      - name: Reset and install all dependencies cleanly
        script: |
          rm -rf node_modules package-lock.json
          npm install --legacy-peer-deps
          npm install --save-dev @vitejs/plugin-react autoprefixer postcss
      - name: Verify required packages exist
        script: |
          test -d node_modules/@vitejs/plugin-react && echo "✅ plugin-react OK"
          test -d node_modules/autoprefixer && echo "✅ autoprefixer OK"
          test -d node_modules/postcss && echo "✅ postcss OK"
      - name: Build the app
        script: |
          npm run build
    artifacts:
      - dist/**
    publishing:
      email:
        recipients:
          - Kpphmri@gmail.com
        notify:
          success: true
          failure: true
